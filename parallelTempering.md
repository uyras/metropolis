Задачи для алгоритма параллельного отжига
======

Планируется встроит параллельный отжиг в классический Метрополис. Сейчас параллелизм идёт по температурам из параметра main/temperatures.

Предлагается сделать параллелизм так же по температурам, но с учетом реплик параллельного отжига. То есть, главный цикл for теперь итерирует по классу temperatureManager, в котором заданы все базовые температуры и температуры из реплик. В классе доступен весь набор температур (базовые + реплики) единым списком. А также отдельными списками базовые температуры, и температуры реплик для каждой базовой.

Алгоритм параллельного отжига:
1. баланс температур (одним из алгоритмов)
2. прогрев (сразу с параллельным отжигом)
3. боевой МК (с параллельным отжигом)

## Конфигурация

Алгоритм включается когда в ini-файле добавлена секция параллельного отжига с двумя обязательными параметрами:

```ini
[parallel_tempering]
balancer = 'simple' ; алгоритм балансировки
each_step = 1000 ; каждые сколько шков делать обмен
```

Отсутствие двух параметров приводит к ошибке запуска программы.
Параметр `balancer` отвечает за алгоритм балансировки температур. Для каждого алгоритма балансировки в ini-файле должна присутствовать соответствующая подсекция с параметрами балансира температур.

## Алгоритмы балансировки и их параметры

### `balancer='manual'`

Алгоритм с возможностью ручной установки температур.

Параметры в конфиг файле:
```ini
[parallel_tempering.balancer.manual]
t0 = 1.1, 2.2, 3.3, 4.4, 5.5
t1 = 2.2, 3.3, 4.4, 5.5, 6.6
t2 = 1.2, 2.3, 3.4, 4.5
```
Для каждой базовой температуры из секции `main/temperature`  создается параметр `t<N>` где `<N>` - проядковый номер, счет начинается с 0. Значениями параметра являются температуры реплик. 
Значения автоматически сортируются при старте программы.
Если для базовой температуры не установлены температуры реплик, то она считается классическим алгоритмом Метрополиса.

### `balancer='unispace'`

Алгоритм балансировки с равномерным распределением температур.
Берется базовая температура $T_i$. Температура реплики $j$: $T^j_i = T_i + j \cdot \Delta T$, где $\Delta T$ - шаг по температуре. 

```ini
[parallel_tempering.balancer.unispace]
dt = 0.1 ; шаг по температуре
n = 5 ; количество реплик для каждой базовой температуре
```

Параметры балансира:
```ini
[parallel_tempering.balancer.unispace]
shoot_cycles = 3 ; сколько циклов пристрелки
exchange_rate=20 ; какой частоты обмена конфигураций придерживаться
t_max  = 10 ; максимальный порог значения температуры для реплики
```

### `balancer='fixed_exchange'`

Алгоритм балансировки, основанный на фиксированной вероятности обмена репликами. Количество реплик и их температуры определяются в ходе предварительного отжига. Алгоритму нельзя использовать температуры реплик больше чем `t_max`. Если базовая температура больше чем `t_max`, то для ней не будет реплик - она считается классическим алгоритмом Метрополиса.

Параметры балансира:
```ini
[parallel_tempering.balancer.fixed_exchange]
shoot_cycles = 3 ; сколько циклов пристрелки
exchange_rate=20 ; какой частоты обмена конфигураций придерживаться
t_max  = 10 ; максимальный порог значения температуры для реплики
```